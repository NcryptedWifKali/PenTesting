from hashlib import sha1
from re import subn

#pilfered from: http://djangosnippets.org/snippets/1508/
def old_hash(word):
    nr = 1345345333
    add = 7
    nr2 = 0x12345671
    for c in (ord(x) for x in word if x not in (' ', '\t')):
            nr^= (((nr & 63)+add)*c)+ (nr << 8) & 0xFFFFFFFF
            nr2= (nr2 + ((nr2 << 8) ^ nr)) & 0xFFFFFFFF
            add= (add + c) & 0xFFFFFFFF

    return {"%08x%08x" % (nr & 0x7FFFFFFF,nr2 & 0x7FFFFFFF):word}

def hash(word):
    word = subn('\r','',word)[0]
    word = subn('\n','',word)[0]
    pass1 = sha1(word).digest()
    pass2 = sha1(pass1).hexdigest()
    return {"*%s"%pass2.upper():word}
